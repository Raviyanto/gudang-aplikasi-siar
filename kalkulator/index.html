<!DOCTYPE html>
<html>
<head>
    <title>Siar Kalkulator Saintifik</title>
    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <style>
        :root { --neon: #39ff14; --bg: #000; }
        body { background: var(--bg); color: var(--neon); font-family: monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        
        /* Tombol Kembali Gaya Neon */
        .btn-back { 
            position: absolute; top: 20px; left: 20px; 
            background: none; border: 1px solid var(--neon); 
            color: var(--neon); padding: 10px 15px; cursor: pointer; 
            font-family: inherit; font-weight: bold;
        }
        .btn-back:hover { background: var(--neon); color: var(--bg); box-shadow: 0 0 10px var(--neon); }

        .calc-box { border: 2px solid var(--neon); padding: 20px; box-shadow: 0 0 15px var(--neon); width: 320px; }
        #screen { width: 100%; height: 60px; background: #111; border: 1px solid var(--neon); color: var(--neon); text-align: right; font-size: 1.8rem; margin-bottom: 15px; padding: 10px; box-sizing: border-box; outline: none; }
        .grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        button { background: none; border: 1px solid var(--neon); color: var(--neon); padding: 15px 5px; cursor: pointer; font-size: 1rem; font-weight: bold; }
        button:hover { background: var(--neon); color: var(--bg); }
        .sci { background: #052205; font-size: 0.8rem; }
        .equal { grid-column: span 2; background: var(--neon); color: var(--bg); }
    </style>
</head>
<body>
    <button class="btn-back" onclick="kembali()">◀ KEMBALI</button>

    <h2>KALKULATOR_SAINTIFIK</h2>
    <div class="calc-box">
        <input type="text" id="screen" readonly value="0">
        <div class="grid">
            <button class="sci" onclick="pakar('sin')">sin</button>
            <button class="sci" onclick="pakar('cos')">cos</button>
            <button class="sci" onclick="pakar('tan')">tan</button>
            <button class="sci" onclick="hapus()">C</button>
            
            <button class="sci" onclick="pakar('sqrt')">√</button>
            <button class="sci" onclick="pakar('pow')">x²</button>
            <button class="sci" onclick="pakar('log')">log</button>
            <button class="sci" onclick="pakar('pi')">π</button>

            <button onclick="tekan('7')">7</button><button onclick="tekan('8')">8</button><button onclick="tekan('9')">9</button><button onclick="tekan('/')">/</button>
            <button onclick="tekan('4')">4</button><button onclick="tekan('5')">5</button><button onclick="tekan('6')">6</button><button onclick="tekan('*')">x</button>
            <button onclick="tekan('1')">1</button><button onclick="tekan('2')">2</button><button onclick="tekan('3')">3</button><button onclick="tekan('-')">-</button>
            <button onclick="tekan('0')">0</button><button onclick="tekan('.')">.</button><button class="equal" onclick="hitung()">=</button><button onclick="tekan('+')">+</button>
        </div>
    </div>

    <script>
        let toko;
        const s = document.getElementById('screen');

        // Hubungkan ke syaraf pusat
        new QWebChannel(qt.webChannelTransport, function(channel) {
            toko = channel.objects.tokoManager; 
        });

        function kembali() {
            if(toko) { 
                toko.buka_aplikasi_siar('dashboard'); // Perintah ke otak.py
            }
        }

        function tekan(v) { if(s.value === '0') s.value = v; else s.value += v; }
        function hapus() { s.value = '0'; }
        function hitung() { try { s.value = eval(s.value); } catch { s.value = 'ERROR'; } }
        
        function pakar(aksi) {
            let n = parseFloat(s.value);
            if (aksi === 'sin') s.value = Math.sin(n * Math.PI / 180).toFixed(4);
            if (aksi === 'cos') s.value = Math.cos(n * Math.PI / 180).toFixed(4);
            if (aksi === 'tan') s.value = Math.tan(n * Math.PI / 180).toFixed(4);
            if (aksi === 'sqrt') s.value = Math.sqrt(n).toFixed(4);
            if (aksi === 'pow') s.value = Math.pow(n, 2);
            if (aksi === 'log') s.value = Math.log10(n).toFixed(4);
            if (aksi === 'pi') s.value = Math.PI.toFixed(4);
        }
    </script>
</body>
</html>
