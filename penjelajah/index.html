<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Siar Hacker Navigator - Pro</title>
    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <style>
        :root { 
            --neon: #39ff14; 
            --bg: #000; 
            --dim: rgba(57, 255, 20, 0.1); 
            --border: 1px solid var(--neon);
        }

        body { 
            background: var(--bg); color: var(--neon); font-family: 'Courier New', monospace; 
            margin: 0; padding: 20px; display: flex; flex-direction: column; height: 100vh;
            box-sizing: border-box; overflow: hidden;
            /* Efek Grid Cyberpunk */
            background-image: linear-gradient(var(--dim) 1px, transparent 1px), 
                              linear-gradient(90deg, var(--dim) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        /* Nav Bar Atas */
        .nav-bar { 
            display: flex; gap: 10px; border-bottom: 2px solid var(--neon); 
            padding-bottom: 15px; margin-bottom: 15px; align-items: center;
        }

        .btn { 
            background: none; border: var(--border); color: var(--neon); 
            padding: 8px 15px; cursor: pointer; font-family: inherit; 
            font-weight: bold; text-transform: uppercase; transition: 0.3s;
        }
        .btn:hover { background: var(--neon); color: #000; box-shadow: 0 0 10px var(--neon); }

        input#urlInput { 
            flex: 1; background: #050505; border: var(--border); 
            color: var(--neon); padding: 10px; outline: none; 
            box-shadow: inset 0 0 5px var(--dim);
        }

        /* Layout Utama */
        .main-container { 
            flex: 1; display: grid; grid-template-columns: 280px 1fr; 
            gap: 20px; overflow: hidden; 
        }

        /* Sidebar Berkas */
        .sidebar { 
            border: var(--border); background: rgba(0, 15, 0, 0.7); 
            padding: 15px; display: flex; flex-direction: column; overflow-y: auto;
        }
        .sidebar h4 { margin: 0 0 10px 0; border-bottom: 1px solid var(--neon); padding-bottom: 5px; }
        
        .file-item { 
            padding: 10px; cursor: pointer; border-bottom: 1px solid var(--dim); 
            font-size: 0.85rem; display: flex; align-items: center; gap: 10px;
        }
        .file-item:hover { background: var(--dim); color: #fff; }

        /* Viewport Browser/Konten */
        .viewport { 
            border: var(--border); background: #fff; position: relative; 
            display: flex; flex-direction: column; overflow: hidden;
        }

        #browser-frame { width: 100%; height: 100%; border: none; display: none; }

        #home-screen { 
            flex: 1; background: #000; display: flex; flex-direction: column; 
            align-items: center; justify-content: center; text-align: center;
        }

        .glitch-text { font-size: 3.5rem; letter-spacing: 10px; text-shadow: 2px 2px var(--dim); }
    </style>
</head>
<body>

    <div class="nav-bar">
        <button class="btn" onclick="tampilHome()">üè† HOME</button>
        <input type="text" id="urlInput" placeholder=">> MASUKKAN URL ATAU CARI_DI_GOOGLE..." onkeydown="if(event.key==='Enter') navigasi()">
        <button class="btn" onclick="navigasi()">JELAJAHI</button>
        <button class="btn" style="border-color: #f33; color: #f33;" onclick="keluarSistem()">‚óÄ KELUAR</button>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <h4>üìÅ BERKAS_LOKAL</h4>
            <div id="file-list">Menghubungkan syaraf...</div>
        </div>

        <div class="viewport">
            <div id="home-screen">
                <div class="glitch-text">SIAR_NAV</div>
                <p style="color: #fff; opacity: 0.5;">MULTI_GATEWAY: WEB & LOCAL_FILES</p>
                <div style="margin-top: 20px; font-size: 0.7rem; color: var(--neon);">
                    STATUS: SYSTEM_READY_V2<br>
                    USER: siar@siarkota
                </div>
            </div>
            <iframe id="browser-frame"></iframe>
        </div>
    </div>

    

    <script>
        let sarafBerkas, toko;

        // Inisialisasi QWebChannel sesuai otak.py
        new QWebChannel(qt.webChannelTransport, function(channel) {
            sarafBerkas = channel.objects.berkasSaraf; // Saraf Berkas modular
            toko = channel.objects.tokoManager;       // Syaraf Pusat
            
            muatFolderLokal("Dokumen/Siar_Catatan"); // Default ke folder catatan
        });

        function muatFolderLokal(path) {
            sarafBerkas.telusuri_folder(path, function(items) {
                const list = document.getElementById('file-list');
                list.innerHTML = "";
                items.forEach(item => {
                    const div = document.createElement('div');
                    div.className = "file-item";
                    div.innerHTML = `<span>${item.tipe === 'folder' ? 'üìÅ' : 'üìÑ'}</span> <span>${item.nama}</span>`;
                    div.onclick = () => { if(item.tipe === 'berkas') bukaPratinjauBerkas(item.path_relatif); };
                    list.appendChild(div);
                });
            });
        }

        function bukaPratinjauBerkas(path) {
            sarafBerkas.baca_isi_berkas(path, function(isi) {
                document.getElementById('home-screen').style.display = 'none';
                const frame = document.getElementById('browser-frame');
                frame.style.display = 'block';
                // Render teks berkas di dalam frame dengan gaya neon
                frame.srcdoc = `<html><body style="background:#000;color:#39ff14;font-family:monospace;padding:30px;white-space:pre-wrap;line-height:1.6;border:1px solid #39ff14;">${isi}</body></html>`;
            });
        }

        function navigasi() {
            let input = document.getElementById('urlInput').value;
            if(!input) return;

            // Logika Pencarian Cerdas
            if(!input.includes('.') && !input.startsWith('http')) {
                input = "https://www.google.com/search?q=" + encodeURIComponent(input);
            } else if (!input.startsWith('http')) {
                input = "https://" + input;
            }

            document.getElementById('home-screen').style.display = 'none';
            const frame = document.getElementById('browser-frame');
            frame.style.display = 'block';
            frame.src = input;
        }

        function tampilHome() {
            document.getElementById('browser-frame').style.display = 'none';
            document.getElementById('home-screen').style.display = 'flex';
        }

        function keluarSistem() {
            // Memanggil fungsi pusat di otak.py untuk kembali ke dashboard
            toko.buka_aplikasi_siar('dashboard');
        }
    </script>
</body>
</html>
